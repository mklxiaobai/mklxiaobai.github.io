<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>Mrefri&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Mrefri&#39;blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;2&#x2F;index.html">
<meta property="og:site_name" content="Mrefri&#39;blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Mrefri&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/bingxiang1.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/touxiang.png" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Mrefri</a></h1>
        </hgroup>
        
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">所有文章</a></li>
                        
                            <li><a  href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">玩转开发工具</a></li>
                        
                            <li><a  href="/categories/digital">玩转数码</a></li>
                        
                            <li><a  href="/categories/algorithm">算法学习</a></li>
                        
                            <li><a  href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="https://github.com/mklxiaobai" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">简书</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱动漫,爱游戏,爱编程,爱运动,爱的太多了!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Mrefri</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/touxiang.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Mrefri</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">玩转开发工具</a></li>
                
                    <li><a href="/categories/digital">玩转数码</a></li>
                
                    <li><a href="/categories/algorithm">算法学习</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/mklxiaobai" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-OAuth2单点登录微博" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/OAuth2%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E5%BE%AE%E5%8D%9A/" class="article-date">
      <time datetime="2019-12-15T13:07:11.803Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/OAuth2%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E5%BE%AE%E5%8D%9A/">OAuth2单点登录微博</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="1-进入新浪微博开放平台"><a href="#1-进入新浪微博开放平台" class="headerlink" title="1.进入新浪微博开放平台"></a>1.进入新浪微博开放平台</h3><p>进入新浪微博开放平台，登录用户信息</p>
<h3 id="2-创建应用"><a href="#2-创建应用" class="headerlink" title="2.创建应用"></a>2.创建应用</h3><p>点击上方菜单栏微连接下网站链接子菜单，点击立即接入，输入应用名，点击创建按钮</p>
<h3 id="3-添加测试账号，授权页"><a href="#3-添加测试账号，授权页" class="headerlink" title="3.添加测试账号，授权页"></a>3.添加测试账号，授权页</h3><p>在应用信息下测试信息中添加测试账号，在高级信息中添加授权网页</p>
<h3 id="4-跳转到客户授权页"><a href="#4-跳转到客户授权页" class="headerlink" title="4.跳转到客户授权页"></a>4.跳转到客户授权页</h3><p>以下为官方文档地址：[<a href="https://open.weibo.com/wiki/Connect/login]" target="_blank" rel="noopener">https://open.weibo.com/wiki/Connect/login]</a><br>跳转链接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.weibo.com/oauth2/authorize?client_id=替换为App Key&amp;response_type=code&amp;redirect_uri=替换为授权网页地址</span><br></pre></td></tr></table></figure>
<p>如果用户同意授权，则会跳转至授权页并赋予code<br> <a href="http://YOUR_REGISTERED_REDIRECT_URI/?code=CODE：" target="_blank" rel="noopener">http://YOUR_REGISTERED_REDIRECT_URI/?code=CODE：</a></p>
<h3 id="5-换取Access-Token"><a href="#5-换取Access-Token" class="headerlink" title="5.换取Access Token"></a>5.换取Access Token</h3><p>通过post方式传参</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://api.weibo.com/oauth2/access_token?client_id=替换为App Key&amp;client_secret=替换为App Secret&amp;grant_type=authorization_code&amp;redirect_uri=替换为授权网页地址&amp;code=上文获取的CODE</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">返回得到access_token</span><br><span class="line">&#123;</span><br><span class="line">    &quot;access_token&quot;: &quot;2.00pDpxyGd3J5bEef6b98778e0ZKsu4&quot;,</span><br><span class="line">    &quot;remind_in&quot;: &quot;157679999&quot;,</span><br><span class="line">    &quot;expires_in&quot;: 157679999,</span><br><span class="line">    &quot;uid&quot;: &quot;6397634785&quot;,</span><br><span class="line">    &quot;isRealName&quot;: &quot;true&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="6-使用AccessToken调用开发API获取用户信息"><a href="#6-使用AccessToken调用开发API获取用户信息" class="headerlink" title="6.使用AccessToken调用开发API获取用户信息"></a>6.使用AccessToken调用开发API获取用户信息</h3><p>官方API文档地址[<a href="https://open.weibo.com/wiki/%E5%BE%AE%E5%8D%9AAPI]" target="_blank" rel="noopener">https://open.weibo.com/wiki/%E5%BE%AE%E5%8D%9AAPI]</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-mysql搭建主从数据库" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/mysql%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93/" class="article-date">
      <time datetime="2019-12-15T13:07:11.798Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/mysql%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E6%95%B0%E6%8D%AE%E5%BA%93/">mysql搭建主从数据库</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="1、docker启动两个mysql实例"><a href="#1、docker启动两个mysql实例" class="headerlink" title="1、docker启动两个mysql实例"></a>1、docker启动两个mysql实例</h2><p>主库：</p>
<p>docker run -p 3307:3306 –name mysql-master <br>//设置挂载目<br>-v /mydata/mysql/master/log:/var/log/mysql <br>-v /mydata/mysql/master/data:/var/lib/mysql <br>-v /mydata/mysql/master/conf:/etc/mysql <br>-e MYSQL_ROOT_PASSWORD=123456 <br>-d mysql:5.6</p>
<p>从库：</p>
<p>docker run -p 3316:3306 –name mysql-slaver-01 <br>-v /mydata/mysql/slaver/log:/var/log/mysql <br>-v /mydata/mysql/slaver/data:/var/lib/mysql <br>-v /mydata/mysql/slaver/conf:/etc/mysql <br>-e MYSQL_ROOT_PASSWORD=123456 <br>-d mysql:5.6</p>
<h2 id="2、修改主从表配置"><a href="#2、修改主从表配置" class="headerlink" title="2、修改主从表配置"></a>2、修改主从表配置</h2><p>//主表配置<br>vim /mydata/mysql/master/conf/my.cnf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server_id=1</span><br><span class="line">log-bin=mysql-bin</span><br><span class="line">read-only=0</span><br><span class="line">binlog-do-db=xxx//数据库表名</span><br><span class="line">//忽略表名</span><br><span class="line">replicate-ignore-db=mysql</span><br><span class="line">replicate-ignore-db=sys</span><br><span class="line">replicate-ignore-db=information_schema</span><br><span class="line">replicate-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>


<p>//从表配置<br>vim /mydata/mysql/slaver/conf/my.cnf</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">server_id=2</span><br><span class="line">log-bin=mysql-bin</span><br><span class="line">read-only=1</span><br><span class="line">binlog-do-db=xxx//数据库表名与主表的表名保持一致</span><br><span class="line">replicate-ignore-db=mysql</span><br><span class="line">replicate-ignore-db=sys</span><br><span class="line">replicate-ignore-db=information_schema</span><br><span class="line">replicate-ignore-db=performance_schema</span><br></pre></td></tr></table></figure>
<p>重启主从数据库</p>
<h2 id="3、主表授权用户同步数据"><a href="#3、主表授权用户同步数据" class="headerlink" title="3、主表授权用户同步数据"></a>3、主表授权用户同步数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql /bin/bash//进入主表容器</span><br><span class="line">mysql –uroot -p//登录</span><br><span class="line">GRANT REPLICATION SLAVE ON *.* to &apos;用户名&apos;@&apos;%&apos; identified by &apos;密码&apos;;//添加授权的用户</span><br><span class="line">show master status//查看状态</span><br></pre></td></tr></table></figure>
<h2 id="4、设置从表使用账号同步主表"><a href="#4、设置从表使用账号同步主表" class="headerlink" title="4、设置从表使用账号同步主表"></a>4、设置从表使用账号同步主表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql-slaver-01 /bin/bash//进入从表容器</span><br><span class="line">mysql –uroot -p//登录</span><br><span class="line">change master to master_host=&apos;主表ip&apos;,master_user=&apos;用户名&apos;,master_password=&apos;密码&apos;,master_log_file=&apos;mysql-bin.000001&apos;,master_log_pos=0,master_port=3307;//用户名密码与主表授权用户一致</span><br><span class="line">start slave;//启动从表同步</span><br><span class="line">show slave status\G;//查看从库状态</span><br></pre></td></tr></table></figure>
<p>当显示</p>
<ul>
<li>Slave_IO_Running: Yes</li>
<li>Slave_SQL_Running: Yes<br>则说明同步成功</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-mybatisPlus注意事项" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/mybatisPlus%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" class="article-date">
      <time datetime="2019-12-15T13:07:11.795Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/mybatisPlus%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/">mybatisPlus注意事项</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="1-与dubbo兼容问题"><a href="#1-与dubbo兼容问题" class="headerlink" title="1 与dubbo兼容问题"></a>1 与dubbo兼容问题</h2><p>dubbo无法直接远程调用自动生成的带泛型的service方法（官方说法是wrapper不支持RPC通信），最好在源项目中自定义方法实现wrapper</p>
<ul>
<li>mybatisPlus官方原文</li>
<li>警告:</li>
</ul>
<p>不支持以及不赞成在 RPC 调用中把 Wrapper 进行传输</p>
<ul>
<li>wrapper 很重</li>
<li>传输 wrapper 可以类比为你的 controller 用 map 接收值(开发一时爽,维护火葬场)</li>
<li>正确的 RPC 调用姿势是写一个 DTO 进行传输,被调用方再根据 DTO 执行相应的操作<h2 id="2-mybatis实现分页"><a href="#2-mybatis实现分页" class="headerlink" title="2 mybatis实现分页"></a>2 mybatis实现分页</h2>在数据库配置类加上分页配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">    public PaginationInterceptor paginationInterceptor() &#123;</span><br><span class="line">        return new PaginationInterceptor();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-mybatisPlus逆向工程创建" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/mybatisPlus%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA/" class="article-date">
      <time datetime="2019-12-15T13:07:11.781Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/mybatisPlus%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%88%9B%E5%BB%BA/">mybatisPlus逆向工程创建</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="1-引入mybatisPlus依赖"><a href="#1-引入mybatisPlus依赖" class="headerlink" title="1.引入mybatisPlus依赖"></a>1.引入mybatisPlus依赖</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-配置生成文件"><a href="#2-配置生成文件" class="headerlink" title="2.配置生成文件"></a>2.配置生成文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">package com.atguigu.mall;</span><br><span class="line"></span><br><span class="line">import com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line">import com.baomidou.mybatisplus.annotation.FieldFill;</span><br><span class="line">import com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line">import com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.DataSourceConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.GlobalConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.PackageConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.StrategyConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.po.TableFill;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.rules.DateType;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line">import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class CodeGenerator &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //创建的module名称</span><br><span class="line">        String moduleName = &quot;abc&quot;;</span><br><span class="line"></span><br><span class="line">        // 1、创建代码生成器</span><br><span class="line">        AutoGenerator mpg = new AutoGenerator();</span><br><span class="line"></span><br><span class="line">        // 2、全局配置</span><br><span class="line">        GlobalConfig gc = new GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(&quot;user.dir&quot;);</span><br><span class="line">        gc.setOutputDir(&quot;E:\\test\\generatortest&quot; + &quot;/src/main/java&quot;);//生成的项目目录</span><br><span class="line">        gc.setAuthor(&quot;mkl&quot;);//作者</span><br><span class="line">        gc.setOpen(false); //生成后是否打开资源管理器</span><br><span class="line">        gc.setFileOverride(false); //重新生成时文件是否覆盖</span><br><span class="line">        gc.setServiceName(&quot;%sService&quot;);	//去掉Service接口的首字母I</span><br><span class="line">        gc.setIdType(IdType.AUTO); //主键策略</span><br><span class="line">        gc.setDateType(DateType.ONLY_DATE);//定义生成的实体类中日期类型</span><br><span class="line">        gc.setSwagger2(true);//开启Swagger2模式</span><br><span class="line">        gc.setBaseColumnList(true);</span><br><span class="line"></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        // 3、数据源配置</span><br><span class="line">        DataSourceConfig dsc = new DataSourceConfig();</span><br><span class="line">        //数据库地址</span><br><span class="line">        dsc.setUrl(&quot;jdbc:mysql://192.168.1.1:3306/test?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&quot;);</span><br><span class="line">        dsc.setDriverName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">        dsc.setUsername(&quot;root&quot;);//数据库账号密码</span><br><span class="line">        dsc.setPassword(&quot;root&quot;);</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        // 4、包配置</span><br><span class="line">        PackageConfig pc = new PackageConfig();</span><br><span class="line">        pc.setModuleName(moduleName); //模块名</span><br><span class="line">        pc.setParent(&quot;com.mkl.test&quot;);</span><br><span class="line">        pc.setController(&quot;controller&quot;);</span><br><span class="line">        pc.setEntity(&quot;entity&quot;);</span><br><span class="line">        pc.setService(&quot;service&quot;);</span><br><span class="line">        pc.setMapper(&quot;mapper&quot;);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        // 5、策略配置</span><br><span class="line">        StrategyConfig strategy = new StrategyConfig();</span><br><span class="line">        strategy.setInclude(moduleName + &quot;_\\w*&quot;);//设置要映射的表名</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);//数据库表映射到实体的命名策略</span><br><span class="line">        strategy.setTablePrefix(pc.getModuleName() + &quot;_&quot;);//设置表前缀不生成</span><br><span class="line">        strategy.setEntityTableFieldAnnotationEnable(true);//是否生成实体时，生成字段注解</span><br><span class="line"></span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);//数据库表字段映射到实体的命名策略</span><br><span class="line">        strategy.setEntityLombokModel(true); // lombok 模型 @Accessors(chain = true) setter链式操作</span><br><span class="line"></span><br><span class="line">        //strategy.setLogicDeleteFieldName(&quot;is_deleted&quot;);//逻辑删除字段名</span><br><span class="line">        //strategy.setEntityBooleanColumnRemoveIsPrefix(true);//去掉布尔值的is_前缀</span><br><span class="line"></span><br><span class="line">        //自动填充</span><br><span class="line">        //TableFill gmtCreate = new TableFill(&quot;gmt_create&quot;, FieldFill.INSERT);</span><br><span class="line">        //TableFill gmtModified = new TableFill(&quot;gmt_modified&quot;, FieldFill.INSERT_UPDATE);</span><br><span class="line">        //ArrayList&lt;TableFill&gt; tableFills = new ArrayList&lt;&gt;();</span><br><span class="line">        //tableFills.add(gmtCreate);</span><br><span class="line">        //tableFills.add(gmtModified);</span><br><span class="line">        //strategy.setTableFillList(tableFills);</span><br><span class="line"></span><br><span class="line">        //strategy.setVersionFieldName(&quot;version&quot;);//乐观锁列</span><br><span class="line"></span><br><span class="line">        strategy.setRestControllerStyle(true); //restful api风格控制器</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(true); //url中驼峰转连字符</span><br><span class="line"></span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        mpg.setTemplateEngine(new FreemarkerTemplateEngine());</span><br><span class="line">        // 6、执行</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行配置类</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-mybatisPlus Mapper接口常用方法" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/mybatisPlus%20Mapper%E6%8E%A5%E5%8F%A3%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/" class="article-date">
      <time datetime="2019-12-15T13:07:11.777Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/mybatisPlus%20Mapper%E6%8E%A5%E5%8F%A3%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/">mybatisPlus Mapper接口常用方法</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="mybatisPlus-Mapper接口常用方法"><a href="#mybatisPlus-Mapper接口常用方法" class="headerlink" title="mybatisPlus Mapper接口常用方法"></a>mybatisPlus Mapper接口常用方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 根据 entity 条件，查询一条记录</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *比较常用！</span><br><span class="line"> * @param queryWrapper 实体对象</span><br><span class="line"> * @return 实体</span><br><span class="line"> */</span><br><span class="line">T selectOne(@Param(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 根据 entity 条件，查询全部记录（并翻页）</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *比较常用！</span><br><span class="line"> * @param page         分页查询条件（可以为 RowBounds.DEFAULT）</span><br><span class="line"> * @param queryWrapper 实体对象封装操作类（可以为 null）</span><br><span class="line"> * @return 实体分页对象</span><br><span class="line"> */</span><br><span class="line">IPage&lt;T&gt; selectPage(IPage&lt;T&gt; page, @Param(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 插入一条记录</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> */</span><br><span class="line">int insert(T entity);</span><br><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 根据 Wrapper 条件，查询总记录数</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * @param queryWrapper 实体对象</span><br><span class="line"> * @return 满足条件记录数</span><br><span class="line"> */</span><br><span class="line">Integer selectCount(@Param(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br><span class="line">/**</span><br><span class="line"> * &lt;p&gt;</span><br><span class="line"> * 根据 entity 条件，查询全部记录</span><br><span class="line"> * &lt;/p&gt;</span><br><span class="line"> *</span><br><span class="line"> * @param queryWrapper 实体对象封装操作类（可以为 null）</span><br><span class="line"> * @return 实体集合</span><br><span class="line"> */</span><br><span class="line">List&lt;T&gt; selectList(@Param(Constants.WRAPPER) Wrapper&lt;T&gt; queryWrapper);</span><br></pre></td></tr></table></figure>
<h2 id="条件构造器QueryWrapper常用方法"><a href="#条件构造器QueryWrapper常用方法" class="headerlink" title="条件构造器QueryWrapper常用方法"></a>条件构造器QueryWrapper常用方法</h2><h4 id="1-allEq"><a href="#1-allEq" class="headerlink" title="1 allEq"></a>1 allEq</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">allEq(BiPredicate&lt;R, V&gt; filter, Map&lt;R, V&gt; params)</span><br><span class="line">allEq(BiPredicate&lt;R, V&gt; filter, Map&lt;R, V&gt; params, boolean null2IsNull)</span><br><span class="line">//null2IsNull : 为true则在map的value为null时调用 isNull 方法,为false时则忽略value为null的</span><br><span class="line">allEq(boolean condition, BiPredicate&lt;R, V&gt; filter, Map&lt;R, V&gt; params, boolean null2IsNull)</span><br></pre></td></tr></table></figure>
<ul>
<li>例1: allEq({id:1,name:”老王”,age:null})—&gt;id = 1 and name = ‘老王’ and age is null</li>
<li>例2: allEq({id:1,name:”老王”,age:null}, false)—&gt;id = 1 and name = ‘老王’<h4 id="2-Eq"><a href="#2-Eq" class="headerlink" title="2 Eq"></a>2 Eq</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eq(R column, Object val)</span><br></pre></td></tr></table></figure>
<p>例: eq(“name”, “老王”)—&gt;name = ‘老王’</p>
<h4 id="3-其余总结"><a href="#3-其余总结" class="headerlink" title="3 其余总结"></a>3 其余总结</h4><p>ne(“name”, “老王”)—&gt;name &lt;&gt; ‘老王’<br>gt(“age”, 18)—&gt;age &gt; 18<br>ge(“age”, 18)—&gt;age &gt;= 18<br>lt(“age”, 18)—&gt;age &lt; 18<br>le(“age”, 18)—&gt;age &lt;= 18<br>between(“age”, 18, 30)—&gt;age between 18 and 30</p>
<ul>
<li>notBetween(“age”, 18, 30)—&gt;age not between 18 and 30</li>
<li>like(“name”, “王”)—&gt;name like ‘%王%’</li>
<li>notLike(“name”, “王”)—&gt;name not like ‘%王%’</li>
<li>likeLeft(“name”, “王”)—&gt;name like ‘%王’</li>
<li>likeRight(“name”, “王”)—&gt;name like ‘王%’</li>
<li>isNull(“name”)—&gt;name is null</li>
<li>isNotNull(“name”)—&gt;name is not null</li>
<li>in(“age”,{1,2,3})—&gt;age in (1,2,3)</li>
<li>groupBy(“id”, “name”)—&gt;group by id,name</li>
<li>orderByAsc(“id”, “name”)—&gt;order by id ASC,name ASC</li>
<li>having(“sum(age) &gt; 10”)—&gt;having sum(age) &gt; 10</li>
<li>eq(“id”,1).or().eq(“name”,”老王”)—&gt;id = 1 or name = ‘老王’</li>
<li>and(i -&gt; i.eq(“name”, “李白”).ne(“status”, “活着”))—&gt;and (name = ‘李白’ and status &lt;&gt; ‘活着’)</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-MultipartFile文件内容解析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/MultipartFile%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E8%A7%A3%E6%9E%90/" class="article-date">
      <time datetime="2019-12-15T13:07:11.773Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/MultipartFile%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E8%A7%A3%E6%9E%90/">MultipartFile文件内容解析</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--拦截类型为multipart的文件--&gt;</span><br><span class="line">@PostMapping(path = &quot;/&quot;, consumes = MediaType.MULTIPART_FORM_DATA_VALUE)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    @ResponseStatus(HttpStatus.CREATED)</span><br><span class="line">    public List&lt;Coffee&gt; batchAddCoffee(@RequestParam(&quot;file&quot;) MultipartFile file) &#123;</span><br><span class="line">        List&lt;Coffee&gt; coffees = new ArrayList&lt;&gt;();</span><br><span class="line">        if (!file.isEmpty()) &#123;</span><br><span class="line">            BufferedReader reader = null;</span><br><span class="line">            try &#123;</span><br><span class="line">            &lt;!--读取字符--&gt;</span><br><span class="line">                reader = new BufferedReader(</span><br><span class="line">                        new InputStreamReader(file.getInputStream()));</span><br><span class="line">                String str;</span><br><span class="line">                &lt;!--每次读取一行--&gt;</span><br><span class="line">                while ((str = reader.readLine()) != null) &#123;</span><br><span class="line">                    String[] arr = StringUtils.split(str, &quot; &quot;);</span><br><span class="line">                    if (arr != null &amp;&amp; arr.length == 2) &#123;</span><br><span class="line">                        coffees.add(coffeeService.saveCoffee(arr[0],</span><br><span class="line">                                Money.of(CurrencyUnit.of(&quot;CNY&quot;),</span><br><span class="line">                                        NumberUtils.createBigDecimal(arr[1]))));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                log.error(&quot;exception&quot;, e);</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                IOUtils.closeQuietly(reader);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return coffees;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-JestClient" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/JestClient/" class="article-date">
      <time datetime="2019-12-15T13:07:11.766Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/JestClient/">JestClient</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringRunner.class)</span><br><span class="line">@SpringBootTest(classes = Application.class)</span><br><span class="line">@ActiveProfiles(&quot;offline&quot;)</span><br><span class="line">public class JestClientTest &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    public JestClient jestClient;</span><br><span class="line">    /**</span><br><span class="line">     * 查询文档</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void getDocumentTest() &#123;</span><br><span class="line">        SearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();</span><br><span class="line">        searchSourceBuilder.query(QueryBuilders.matchQuery(&quot;empNo&quot;, &quot;123&quot;));</span><br><span class="line">        searchSourceBuilder.from(0);</span><br><span class="line">        searchSourceBuilder.size(30);</span><br><span class="line">        Search search = new Search.Builder(searchSourceBuilder.toString())</span><br><span class="line">                // multiple index or types can be added.</span><br><span class="line">                .addIndex(&quot;*dol*&quot;)</span><br><span class="line">                .addType(&quot;cloud_logs&quot;)</span><br><span class="line">                .build();</span><br><span class="line">        try &#123;</span><br><span class="line">            SearchResult result = jestClient.execute(search);</span><br><span class="line">            List&lt;SearchResult.Hit&lt;Post, Void&gt;&gt; hits = result.getHits(Post.class);</span><br><span class="line">            List&lt;Post&gt; articles = result.getSourceAsObjectList(Post.class);</span><br><span class="line">            System.out.println(articles);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 给索引添加别名</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void createAliasTest() &#123;</span><br><span class="line">        List&lt;String&gt; indics = new ArrayList&lt;&gt;();</span><br><span class="line">        indics.add(&quot;posts&quot;);</span><br><span class="line">        indics.add(&quot;postsss&quot;);</span><br><span class="line">        try &#123;</span><br><span class="line">            AddAliasMapping addAliasMapping = new AddAliasMapping.Builder(indics, &quot;mypost&quot;).build();</span><br><span class="line">            JestResult jestResult = jestClient.execute(new ModifyAliases.Builder(addAliasMapping).build());</span><br><span class="line">            System.out.println(&quot;result:&quot; + jestResult.getJsonString());</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 根据index获取别名</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void getIndexAlias() &#123;</span><br><span class="line">        String index = &quot;company&quot;;</span><br><span class="line">        try &#123;</span><br><span class="line">            JestResult jestResult = jestClient.execute(new GetAliases.Builder().addIndex(index).build());</span><br><span class="line">            System.out.println(jestResult.getJsonString());</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 判断index是否存在</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void indicesExists()&#123;</span><br><span class="line">        String index = &quot;posoooots&quot;;</span><br><span class="line">        IndicesExists indicesExists=new IndicesExists.Builder(index).build();</span><br><span class="line">        JestResult jestResult=null;</span><br><span class="line">        try&#123;</span><br><span class="line">            jestResult = jestClient.execute(indicesExists);</span><br><span class="line">            System.out.println(jestResult.isSucceeded());</span><br><span class="line">        &#125;catch (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * count</span><br><span class="line">     * 必须要指定精确的index</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void countTest() throws IOException &#123;</span><br><span class="line">        Count count = new Count.Builder()</span><br><span class="line">                .addIndex(&quot;cvf_2018-10-09&quot;)</span><br><span class="line">                .addType(&quot;cloud_logs&quot;)</span><br><span class="line">                .build();</span><br><span class="line"> </span><br><span class="line">        CountResult result = jestClient.execute(count);</span><br><span class="line">        System.out.println(result.getCount());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    @Test</span><br><span class="line">    public void getIndexList() throws Exception&#123;</span><br><span class="line">        GetMapping getMapping=new GetMapping.Builder().build();</span><br><span class="line">        JestResult jestResult=jestClient.execute(getMapping);</span><br><span class="line">        System.out.println(jestResult.getJsonString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-IDEA快捷键" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="article-date">
      <time datetime="2019-12-15T13:07:11.762Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/IDEA%E5%BF%AB%E6%8D%B7%E9%94%AE/">IDEA快捷键</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li>Ctrl +R在当前文件进行文本替换 （必备）</li>
<li>Ctrl + K    版本控制提交项目</li>
<li>Ctrl + T    版本控制更新项目</li>
<li>Ctrl + H    显示当前类的层次结构</li>
<li>Alt + Insert    代码自动生成，如生成对象的 set / get 方法，构造函数，toString() 等</li>
<li>Ctrl + Alt + T    对选中的代码弹出环绕选项弹出层</li>
<li>Ctrl + Shift + F    根据输入内容查找整个项目 或 指定目录内文件 （必备）</li>
<li>Ctrl + Shift + R    根据输入内容替换对应内容，范围为整个项目 或 指定目录内文件 （必备）</li>
<li>F2    跳转到下一个高亮错误 或 警告位置 （必备）</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-ELK日志分析系统搭建" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/ELK%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/" class="article-date">
      <time datetime="2019-12-15T13:07:11.759Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/ELK%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA/">ELK日志分析系统搭建</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>此日志记录使用Docker搭建Elasticsearch、Logstash、Kibana日志收集分析系统</p>
<h2 id="1-下载docker镜像-三个镜像的版本必须对应，否则部署可能会出现异常"><a href="#1-下载docker镜像-三个镜像的版本必须对应，否则部署可能会出现异常" class="headerlink" title="1.下载docker镜像(三个镜像的版本必须对应，否则部署可能会出现异常)"></a>1.下载docker镜像(三个镜像的版本必须对应，否则部署可能会出现异常)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull elasticsearch:5.6.11</span><br><span class="line">docker pull kibana:5.6.11</span><br><span class="line">docker pull logstash:5.6.15</span><br></pre></td></tr></table></figure>
<h2 id="分别创建实例"><a href="#分别创建实例" class="headerlink" title="分别创建实例"></a>分别创建实例</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//创建elasticsearch的配置文件</span><br><span class="line">mkdir -p /mydata/elasticsearch/config</span><br><span class="line">mkdir -p /mydata/elasticsearch/data</span><br><span class="line">//配置elasticsearch.yml任意端口访问</span><br><span class="line">echo &quot;http.host: 0.0.0.0&quot; &gt;&gt; /mydata/elasticsearch/config/elasticsearch.yml</span><br><span class="line"></span><br><span class="line">docker run --name elasticsearch -p 9200:9200 -p 9300:9300 \</span><br><span class="line">//启动单体实例</span><br><span class="line">-e &quot;discovery.type=single-node&quot; \</span><br><span class="line">//配置内存</span><br><span class="line">-e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot; \</span><br><span class="line">//外挂配置文件</span><br><span class="line">-v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml \</span><br><span class="line">-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data -d elasticsearch:5.6.11</span><br></pre></td></tr></table></figure>
<p>创建Kibana实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --name kibana -e ELASTICSEARCH_URL=http://xxx:9200 -p 5601:5601 \</span><br><span class="line">-d kibana:5.6.11</span><br></pre></td></tr></table></figure>
<p>创建Logstash实例<br>在mydata/logstash中创建logstash.conf文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">input &#123;</span><br><span class="line">    tcp &#123;</span><br><span class="line">        port =&gt; 4560</span><br><span class="line">        //配置json解析</span><br><span class="line">        codec =&gt; json_lines</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">output&#123;</span><br><span class="line">  elasticsearch &#123; </span><br><span class="line">	hosts =&gt; [&quot;xxx:9200&quot;] </span><br><span class="line">	index =&gt; &quot;abc&quot;</span><br><span class="line">	&#125;</span><br><span class="line">  stdout &#123; codec =&gt; rubydebug &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 4560:4560 \</span><br><span class="line">//挂载配置文件</span><br><span class="line">-v /mydata/logstash/logstash.conf:/etc/logstash.conf \</span><br><span class="line">//关联elasticsearch</span><br><span class="line">--link elasticsearch:elasticsearch \</span><br><span class="line">--name logstash logstash:5.6.15 \</span><br><span class="line">//强制加载配置文件</span><br><span class="line">logstash -f /etc/logstash.conf</span><br></pre></td></tr></table></figure>



      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-elasticsearch Query DSL 相关操作" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2019/12/15/elasticsearch%20Query%20DSL%20%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/" class="article-date">
      <time datetime="2019-12-15T13:07:11.755Z" itemprop="datePublished">2019-12-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2019/12/15/elasticsearch%20Query%20DSL%20%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/">elasticsearch Query DSL 相关操作</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="1-基本语法格式"><a href="#1-基本语法格式" class="headerlink" title="1 基本语法格式"></a>1 基本语法格式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match_all&quot;: &#123;&#125;//查找所有</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;from&quot;: 0,</span><br><span class="line">  &quot;size&quot;: 5,</span><br><span class="line">  &quot;sort&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;account_number&quot;: &#123;</span><br><span class="line">        &quot;order&quot;: &quot;desc&quot;//排序</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-返回部分字段"><a href="#2-返回部分字段" class="headerlink" title="2 返回部分字段"></a>2 返回部分字段</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match_all&quot;: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;from&quot;: 0,</span><br><span class="line">  &quot;size&quot;: 5,</span><br><span class="line">  &quot;_source&quot;: [&quot;age&quot;,&quot;balance&quot;]//只查询相关字段</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-匹配查询"><a href="#3-匹配查询" class="headerlink" title="3 匹配查询"></a>3 匹配查询</h3><p>非字符串精确查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;account_number&quot;: &quot;20&quot;//查询account_number=20</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//字符串模糊查询</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;address&quot;: &quot;mill&quot;//查询%mill%</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//多个单词模糊查询 按相关性大小排序</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;address&quot;: &quot;mill road&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//精确匹配</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match_phrase&quot;: &#123;</span><br><span class="line">      &quot;address&quot;: &quot;mill road&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//多字段匹配相应字符串</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;multi_match&quot;: &#123;</span><br><span class="line">      &quot;query&quot;: &quot;mill&quot;,</span><br><span class="line">      &quot;fields&quot;: [&quot;state&quot;,&quot;address&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//must：必须达到must列举的所有条件</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must&quot;: [</span><br><span class="line">        &#123; &quot;match&quot;: &#123; &quot;address&quot;: &quot;mill&quot; &#125; &#125;,</span><br><span class="line">        &#123; &quot;match&quot;: &#123; &quot;gender&quot;: &quot;M&quot; &#125; &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//should：应该达到should列举的条件，如果达到会增加相关文档的评分</span><br><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must&quot;: [ </span><br><span class="line">&#123; &quot;match&quot;: &#123; &quot;address&quot;: &quot;mill&quot; &#125; &#125;,</span><br><span class="line">        &#123; &quot;match&quot;: &#123; &quot;gender&quot;: &quot;M&quot; &#125; &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;should&quot;: [</span><br><span class="line">        &#123;&quot;match&quot;: &#123; &quot;address&quot;: &quot;lane&quot; &#125;&#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-aggregations（执行聚合）"><a href="#3-aggregations（执行聚合）" class="headerlink" title="3.aggregations（执行聚合）"></a>3.aggregations（执行聚合）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;address&quot;: &quot;mill&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;aggs&quot;: &#123;</span><br><span class="line">    &quot;group_by_state&quot;: &#123;</span><br><span class="line">      &quot;terms&quot;: &#123;</span><br><span class="line">        &quot;field&quot;: &quot;age&quot;//按年龄分组</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;avg_age&quot;: &#123;</span><br><span class="line">      &quot;avg&quot;: &#123;</span><br><span class="line">        &quot;field&quot;: &quot;age&quot;//求平均值</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;size&quot;: 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET bank/account/_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match_all&quot;: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;aggs&quot;: &#123;</span><br><span class="line">    &quot;age_avg&quot;: &#123;</span><br><span class="line">      &quot;terms&quot;: &#123;</span><br><span class="line">        &quot;field&quot;: &quot;age&quot;,//先求年龄分布</span><br><span class="line">        &quot;size&quot;: 1000</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;aggs&quot;: &#123;</span><br><span class="line">        &quot;banlances_avg&quot;: &#123;</span><br><span class="line">          &quot;avg&quot;: &#123;</span><br><span class="line">            &quot;field&quot;: &quot;balance&quot;//再求平均工资</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ,</span><br><span class="line">  &quot;size&quot;: 1000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &amp;raquo;</a>
    </nav>
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 Mrefri
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>